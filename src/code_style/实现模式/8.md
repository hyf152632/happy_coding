# 方法

将一个程序的逻辑分割成许多方法，相当于告诉别人“这些逻辑片断之
间的联系不紧密”。再把方法分门别类放进类中，把类分门别类放进包中，就
是在进一步地传递同样的信息。把这段代码放进一个方法，把那段代码放进
另一个方法，就是在告诉阅读者两段代码之间的关系不密切，阅读者可以分
别阅读并加以理解。更进一步，方法的命名也是与阅读者沟通的机会，它可
以告诉阅读者这段计算的目的何在，让阅读者免受实现的影响。阅读者通常
单凭阅读方法的名字就可以一眼分辨出哪些是自己要找的。

方法干净利落地解决了重用的问题。

将大段的计算分割成若干方法，在概念上是简单的：将应该放在一起的
片段放在一起，将应该分隔开的片段分隔开。不过在实践中首先要花费时间、
精力和创造力去弄清楚哪些东西应该归在一起，哪些又不应该。其次还要找
出最佳的划分方案。目前看起来很好的划分随着系统逻辑的改变可能会变得
不合适。好的划分方案应该能够减少你的工作量，但要分清楚哪些才是最佳
的方案则需要有丰富的经验支持。

组合方法
通过对其他方法的调用来组合出新的方法，被调用方法应大致属于相同
的抽象层次。

代码作者将逻辑划分成方法的时候要同时满足走马观花和细嚼慢咽的需
要，这是一项挑战。我发现当把代码分解成相对较小（至少以 C 语言的标准
来说）的方法时，读起来最舒服。要点在于识别出哪些细节是相对独立的，
可以把它们转移到辅助方法中去。有时候会遇到大量细节，不难理解但不易
分割，此时我会建立一个方法对象让所有细节都各归其位。

组合方法时应当根据事实而非推测。先让代码正常工作，然后再决定该
怎么安排它的结构。如果一开始就花很多时间考虑代码的结构，那么一旦在
实现过程中发现一些新东西，就不得不推翻前面的结构重新来过。当逻辑的
全部细节都摊开在面前之后，会更容易合理地组合方法。有时候我以为已经
了解方法该如何组合，但当我完成逻辑的分割之后，才发现结果变得更难以
阅读。在这种情况下，我会重新展开所有的方法，直到再次出现“巨无霸”
方法的时候再根据最新的经验重新分割它。

实现策略是最常出现在方法名称中的枝节信息

调用代码是在讲述一个故事，好的方法命名会让故事讲述得更流畅。

在选择可见性的时候要在两件事情之间进行权衡。一是未来的灵活性，
狭窄的接口更便于未来的变化。二是调用对象的代价，过于狭窄的接口让对
象的所有客户都被迫执行更多不必要的工作。二者的平衡是决定可见性时要
考虑的核心问题。

要谨慎地暴露方法，从最严格的可见性开始，有必要时再暴露。如果一
种方法不再需要那么高的可见性，就应该降低它的可见性。只有当所有的调
用者都在你的掌控范围内才有可能降低可见性，因为只有这样才可以保证调
用者在所依赖的方法消失之后能被修复。我还常常注意到一种情况，当我换
一种方式使用对象的时候，会发现最初认为属于 private 的方法有可能成为接
口中一个有价值的成员。

程序的细分是为了人，是为了迁就人类容易上当、拿不定主意却又独出
心裁的头脑，但对于计算机来说是没什么好处的。不管是一团又长又难看的
代码，还是一群相亲相爱的对象，计算机都照样运行。对于人类阅读者，创
建对象相当于声明说：这些状态是为了支持这个计算而放到一起的，至于它
们的细节，现在不必关心。
