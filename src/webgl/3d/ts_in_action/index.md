#

![webgl类结构图](./webgl%E7%B1%BB%E7%BB%93%E6%9E%84%E5%9B%BE.png);

WebGL最关键的一个功能是将3D顶点(Vertex)表 示的几何图形光栅化(Rasterization)成片段 (Fragment)，每个片段都具有与像素对应的坐标 值、颜色值、深度值、模板值等属性。接下来这些片 段要经历一系列片段测试和操作，如果测试成功，才 能将片段中的各种数据写入对应的帧缓冲区。例如片 段的颜色值就写入到颜色缓冲区去，深度值就写入深 度缓冲区(如果存在深度缓冲区)，而模板值就写入 模板缓冲区(如果存在模板缓冲区)。

WebGLContextAttributes中preserveDrawingBuffer对 帧缓冲区的影响

WebGLRenderingContext类提供了3个方法来查询 或设置一些布尔类型的渲染状态

enable(cap: GLenum): void; // 开启某个渲染状态
isEnabled(cap: GLenum): GLboolean; // 查询某个渲染状态是否开启
disable(cap: GLenum): void; // 关闭某个渲染状态

当WebGLRenderingContext上下文渲染对象丢失时，会触发WebGLContextEvent事件。可以直接在 canvas元素中监听该事件。

视矩阵、投影矩阵、裁剪和视口
WebGL的核心是将一个三维顶点表示的场景或物体 光栅化成二维像素图像，然后显示在输出设备上，例 如屏幕等。在整个过程中，需要将整个场景或物体从 三维坐标系变换成屏幕坐标系的表示，要完成这个过 程，需要经历3个步骤:
(1)坐标系变换:将局部坐标系表示的点变换到 世界坐标系中，然后再变换到视图坐标系，接着继续 变换到投影坐标系(又叫裁剪坐标系)。一般情况 下，在绘制场景或物体时需要组合多种变换。我们可 以使用矩阵来变换各种坐标系。
(2)裁剪操作:由于最后总是显示在例如canvas 元素指定的矩形区块中，因此位于该矩形区块之外的 物体都会被裁剪掉，在WebGL中可以用scissor方法设 置裁剪区域。
(3)视口变换:经过变换后的坐标和canvas元素 指定的矩形区块中的像素必须要建立对应关系，这个 过程被称为视口变换。在WebGL中可以用viewport方法 设置视口区域。
